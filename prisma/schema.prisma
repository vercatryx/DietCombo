generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Admin {
  id        String   @id @default(uuid()) @db.VarChar(36)
  username  String   @unique @db.VarChar(255)
  password  String   @db.VarChar(255)
  name      String?  @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@map("admins")
}

model AppSettings {
  id                      String   @id @default("1") @db.VarChar(36)
  weeklyCutoffDay         String?  @default("Friday") @map("weekly_cutoff_day") @db.VarChar(50)
  weeklyCutoffTime        String?  @default("17:00") @map("weekly_cutoff_time") @db.VarChar(50)
  reportEmail             String?  @map("report_email") @db.VarChar(255)
  enablePasswordlessLogin Boolean? @default(false) @map("enable_passwordless_login")
  createdAt               DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt               DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@map("app_settings")
}

model BillingRecord {
  id        String   @id @default(uuid()) @db.VarChar(36)
  clientId  String   @map("client_id") @db.VarChar(36)
  orderId   String?  @map("order_id") @db.VarChar(36)
  status    String   @db.VarChar(50)
  remarks   String?
  navigator String?  @db.VarChar(255)
  amount    Decimal  @db.Decimal(10, 2)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([clientId], map: "idx_billing_records_client_id")
  @@index([orderId], map: "idx_billing_records_order_id")
  @@map("billing_records")
}

model BoxQuota {
  id          String   @id @default(uuid()) @db.VarChar(36)
  boxTypeId   String   @map("box_type_id") @db.VarChar(36)
  categoryId  String   @map("category_id") @db.VarChar(36)
  targetValue Decimal  @map("target_value") @db.Decimal(10, 2)
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@index([boxTypeId], map: "idx_box_quotas_box_type_id")
  @@index([categoryId], map: "idx_box_quotas_category_id")
  @@map("box_quotas")
}

model BoxType {
  id                String              @id @default(uuid()) @db.VarChar(36)
  name              String              @db.VarChar(255)
  vendorId          String?             @map("vendor_id") @db.VarChar(36)
  isActive          Boolean?            @default(true) @map("is_active")
  priceEach         Decimal?            @map("price_each") @db.Decimal(10, 2)
  createdAt         DateTime            @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt         DateTime            @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  client_box_orders client_box_orders[]

  @@index([vendorId], map: "idx_box_types_vendor_id")
  @@map("box_types")
}

model CityColor {
  id        String   @id @default(uuid()) @db.VarChar(36)
  city      String   @unique @db.VarChar(100)
  color     String   @db.VarChar(7)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@map("city_colors")
}

model ClientStatus {
  id                    String   @id @default(uuid()) @db.VarChar(36)
  name                  String   @db.VarChar(255)
  isSystemDefault       Boolean? @default(false) @map("is_system_default")
  deliveriesAllowed     Boolean? @default(true) @map("deliveries_allowed")
  requiresUnitsOnChange Boolean? @default(false) @map("requires_units_on_change")
  createdAt             DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt             DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@map("client_statuses")
}

model Client {
  id                   String              @id @default(uuid()) @db.VarChar(36)
  fullName             String              @map("full_name") @db.VarChar(510)
  firstName            String?             @map("first_name") @db.VarChar(510)
  lastName             String?             @map("last_name") @db.VarChar(510)
  email                String?             @db.VarChar(510)
  address              String?
  apt                  String?             @db.VarChar(100)
  city                 String?             @db.VarChar(200)
  state                String?             @db.VarChar(4)
  zip                  String?             @db.VarChar(20)
  county               String?             @db.VarChar(200)
  phoneNumber          String?             @map("phone_number") @db.VarChar(510)
  secondaryPhoneNumber String?             @map("secondary_phone_number") @db.VarChar(510)
  clientIdExternal     String?             @map("client_id_external") @db.VarChar(200)
  caseIdExternal       String?             @map("case_id_external") @db.VarChar(200)
  medicaid             Boolean?            @default(false)
  paused               Boolean?            @default(false)
  complex              Boolean?            @default(false)
  bill                 Boolean?            @default(true)
  delivery             Boolean?            @default(true)
  dislikes             String?
  latitude             Float?
  longitude            Float?
  lat                  Float?
  lng                  Float?
  geocodedAt           DateTime?           @map("geocoded_at") @db.Timestamp(6)
  billings             Json?
  visits               Json?
  signToken            String?             @unique @map("sign_token") @db.VarChar(510)
  navigatorId          String?             @map("navigator_id") @db.VarChar(36)
  endDate              DateTime?           @map("end_date") @db.Date
  screeningTookPlace   Boolean?            @default(false) @map("screening_took_place")
  screeningSigned      Boolean?            @default(false) @map("screening_signed")
  screeningStatus      String?             @default("not_started") @map("screening_status") @db.VarChar(50)
  notes                String?
  statusId             String?             @map("status_id") @db.VarChar(36)
  serviceType          String              @map("service_type") @db.VarChar(50)
  approvedMealsPerWeek Int?                @map("approved_meals_per_week")
  parentClientId       String?             @map("parent_client_id") @db.VarChar(36)
  dob                  DateTime?           @db.Date
  cin                  String?             @db.VarChar(50)
  authorizedAmount     Decimal?            @map("authorized_amount") @db.Decimal(10, 2)
  expirationDate       DateTime?           @map("expiration_date") @db.Date
  activeOrder          Json?               @map("active_order")
  assignedDriverId     String?             @map("assigned_driver_id") @db.VarChar(36)
  createdAt            DateTime            @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt            DateTime            @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  updatedBy            String?             @map("updated_by") @db.VarChar(510)
  client_box_orders       client_box_orders[]
  mealPlannerCustomItems  MealPlannerCustomItem[]
  mealPlannerOrders       MealPlannerOrder[]
  assignedDriver          Driver?             @relation(fields: [assignedDriverId], references: [id], onDelete: SetNull)

  @@index([clientIdExternal], map: "idx_clients_client_id_external")
  @@index([caseIdExternal], map: "idx_clients_case_id_external")
  @@index([signToken], map: "idx_clients_sign_token")
  @@index([navigatorId], map: "idx_clients_navigator_id")
  @@index([statusId], map: "idx_clients_status_id")
  @@index([parentClientId], map: "idx_clients_parent_client_id")
  @@index([assignedDriverId], map: "idx_clients_assigned_driver_id")
  @@map("clients")
}

model DeliveryHistory {
  id                   String   @id @default(uuid()) @db.VarChar(36)
  clientId             String   @map("client_id") @db.VarChar(36)
  vendorId             String   @map("vendor_id") @db.VarChar(36)
  serviceType          String   @map("service_type") @db.VarChar(50)
  deliveryDate         DateTime @map("delivery_date") @db.Date
  itemsSummary         String?  @map("items_summary")
  proofOfDeliveryImage String?  @map("proof_of_delivery_image") @db.VarChar(500)
  createdAt            DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([clientId], map: "idx_delivery_history_client_id")
  @@index([vendorId], map: "idx_delivery_history_vendor_id")
  @@map("delivery_history")
}

model Driver {
  id        String    @id @default(uuid()) @db.VarChar(36)
  day       String    @db.VarChar(40)
  name      String    @db.VarChar(510)
  color     String?   @db.VarChar(14)
  stopIds   Json?     @map("stop_ids")
  createdAt DateTime  @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime  @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  assignedClients Client[]

  @@index([day], map: "idx_drivers_day")
  @@index([name], map: "idx_drivers_name")
  @@map("drivers")
}

model Equipment {
  id        String   @id @default(uuid()) @db.VarChar(36)
  name      String   @db.VarChar(255)
  price     Decimal  @db.Decimal(10, 2)
  vendorId  String?  @map("vendor_id") @db.VarChar(36)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@index([vendorId], map: "idx_equipment_vendor_id")
  @@map("equipment")
}

model FilledForm {
  id        String   @id @default(uuid()) @db.VarChar(36)
  formId    String   @map("form_id") @db.VarChar(36)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([formId], map: "idx_filled_forms_form_id")
  @@map("filled_forms")
}

model Form {
  id          String   @id @default(uuid()) @db.VarChar(36)
  title       String   @db.VarChar(255)
  description String?
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@map("forms")
}

model FormAnswer {
  id           String   @id @default(uuid()) @db.VarChar(36)
  filledFormId String   @map("filled_form_id") @db.VarChar(36)
  questionId   String   @map("question_id") @db.VarChar(36)
  value        String
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([filledFormId], map: "idx_form_answers_filled_form_id")
  @@index([questionId], map: "idx_form_answers_question_id")
  @@map("form_answers")
}

model FormSubmission {
  id           String   @id @default(uuid()) @db.VarChar(36)
  formId       String   @map("form_id") @db.VarChar(36)
  clientId     String?  @map("client_id") @db.VarChar(36)
  token        String   @unique @db.VarChar(255)
  status       String?  @default("pending") @db.VarChar(50)
  data         Json?
  signatureUrl String?  @map("signature_url") @db.VarChar(500)
  pdfUrl       String?  @map("pdf_url") @db.VarChar(500)
  comments     String?
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@index([token], map: "idx_form_submissions_token")
  @@index([clientId], map: "idx_form_submissions_client_id")
  @@index([formId], map: "idx_form_submissions_form_id")
  @@map("form_submissions")
}

model ItemCategory {
  id         String   @id @default(uuid()) @db.VarChar(36)
  name       String   @db.VarChar(255)
  setValue   Decimal? @map("set_value") @db.Decimal(10, 2)
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt  DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  meal_type  String   @default("Lunch")
  sort_order Int?     @default(0)

  @@index([meal_type], map: "idx_item_categories_meal_type")
  @@map("item_categories")
}

model MenuItem {
  id                   String                @id @default(uuid()) @db.VarChar(36)
  vendorId             String?               @map("vendor_id") @db.VarChar(36)
  name                 String                @db.VarChar(255)
  value                Decimal               @db.Decimal(10, 2)
  priceEach            Decimal?              @map("price_each") @db.Decimal(10, 2)
  isActive             Boolean?              @default(true) @map("is_active")
  categoryId           String?               @map("category_id") @db.VarChar(36)
  quotaValue           Decimal?              @map("quota_value") @db.Decimal(10, 2)
  minimumOrder         Int?                  @default(0) @map("minimum_order")
  createdAt            DateTime              @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt            DateTime              @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  image_url            String?
  sort_order           Int?                  @default(0)
  mealPlannerOrderItems MealPlannerOrderItem[]

  @@index([vendorId], map: "idx_menu_items_vendor_id")
  @@index([categoryId], map: "idx_menu_items_category_id")
  @@map("menu_items")
}

model Navigator {
  id        String   @id @default(uuid()) @db.VarChar(36)
  name      String   @db.VarChar(255)
  email     String?  @db.VarChar(255)
  password  String?  @db.VarChar(255)
  isActive  Boolean? @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@map("navigators")
}

model NavigatorLog {
  id          String   @id @default(uuid()) @db.VarChar(36)
  navigatorId String   @map("navigator_id") @db.VarChar(36)
  clientId    String   @map("client_id") @db.VarChar(36)
  action      String   @db.VarChar(255)
  details     String?
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([navigatorId], map: "idx_navigator_logs_navigator_id")
  @@index([clientId], map: "idx_navigator_logs_client_id")
  @@map("navigator_logs")
}

model Nutritionist {
  id        String   @id @default(uuid()) @db.VarChar(36)
  name      String   @db.VarChar(255)
  email     String?  @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@map("nutritionists")
}

model Order {
  id                    String    @id @default(uuid()) @db.VarChar(36)
  clientId              String    @map("client_id") @db.VarChar(36)
  serviceType           String    @map("service_type") @db.VarChar(50)
  caseId                String?   @map("case_id") @db.VarChar(255)
  status                String    @default("pending") @db.VarChar(50)
  scheduledDeliveryDate DateTime? @map("scheduled_delivery_date") @db.Date
  actualDeliveryDate    DateTime? @map("actual_delivery_date") @db.Date
  deliveryDay           String?   @map("delivery_day") @db.VarChar(50)
  deliveryDistribution  Json?     @map("delivery_distribution")
  totalValue            Decimal?  @map("total_value") @db.Decimal(10, 2)
  totalItems            Int?      @map("total_items")
  billAmount            Decimal?  @map("bill_amount") @db.Decimal(10, 2)
  notes                 String?
  proofOfDeliveryUrl    String?   @map("proof_of_delivery_url") @db.VarChar(500)
  orderNumber           Int?      @unique @map("order_number")
  lastUpdated           DateTime  @default(now()) @updatedAt @map("last_updated") @db.Timestamp(6)
  updatedBy             String?   @map("updated_by") @db.VarChar(255)
  createdAt             DateTime  @default(now()) @map("created_at") @db.Timestamp(6)
  vendorId              String?   @map("vendor_id") @db.VarChar(36)
  // stops relation removed - orderId in stops can now reference either orders.id or upcoming_orders.id

  @@index([orderNumber], map: "idx_orders_order_number")
  @@index([clientId], map: "idx_orders_client_id")
  @@index([status], map: "idx_orders_status")
  @@index([scheduledDeliveryDate], map: "idx_orders_scheduled_delivery_date")
  @@index([vendorId], map: "idx_orders_vendor_id")
  @@map("orders")
}

model OrderBoxSelection {
  id        String   @id @default(uuid()) @db.VarChar(36)
  orderId   String   @map("order_id") @db.VarChar(36)
  vendorId  String   @map("vendor_id") @db.VarChar(36)
  boxTypeId String?  @map("box_type_id") @db.VarChar(36)
  quantity  Int      @default(1)
  items     Json?
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([orderId], map: "idx_order_box_selections_order_id")
  @@index([vendorId], map: "idx_order_box_selections_vendor_id")
  @@index([boxTypeId], map: "idx_order_box_selections_box_type_id")
  @@map("order_box_selections")
}

model OrderHistory {
  id        String   @id @default(uuid()) @db.VarChar(36)
  clientId  String   @map("client_id") @db.VarChar(36)
  who       String   @db.VarChar(255)
  summary   String
  timestamp DateTime @default(now()) @map("timestamp") @db.Timestamp(6)

  @@index([clientId], map: "idx_order_history_client_id")
  @@map("order_history")
}

model OrderItem {
  id                String           @id @default(uuid()) @db.VarChar(36)
  vendorSelectionId String           @map("vendor_selection_id") @db.VarChar(36)
  menuItemId        String?          @map("menu_item_id") @db.VarChar(36)
  quantity          Int              @default(1)
  createdAt         DateTime         @default(now()) @map("created_at") @db.Timestamp(6)
  notes             String?
  custom_name       String?
  custom_price      Decimal?         @db.Decimal(10, 2)
  meal_item_id      String?          @db.VarChar(36)
  breakfast_items   breakfast_items? @relation(fields: [meal_item_id], references: [id], onUpdate: NoAction)

  @@index([vendorSelectionId], map: "idx_order_items_vendor_selection_id")
  @@index([menuItemId], map: "idx_order_items_menu_item_id")
  @@map("order_items")
}

model OrderVendorSelection {
  id        String   @id @default(dbgenerated("(uuid_generate_v4())::text")) @db.VarChar(36)
  orderId   String   @map("order_id") @db.VarChar(36)
  vendorId  String?  @map("vendor_id") @db.VarChar(36)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([orderId], map: "idx_order_vendor_selections_order_id")
  @@index([vendorId], map: "idx_order_vendor_selections_vendor_id")
  @@map("order_vendor_selections")
}

model PasswordlessCode {
  id        String   @id @default(uuid()) @db.VarChar(36)
  email     String   @db.VarChar(255)
  code      String   @db.VarChar(10)
  expiresAt DateTime @default(now()) @map("expires_at") @db.Timestamp(6)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  attempts  Int?     @default(0)

  @@index([email], map: "idx_passwordless_codes_email")
  @@map("passwordless_codes")
}

model Question {
  id                    String   @id @default(uuid()) @db.VarChar(36)
  formId                String   @map("form_id") @db.VarChar(36)
  text                  String
  type                  String   @db.VarChar(50)
  options               Json?
  conditionalTextInputs Json?    @map("conditional_text_inputs")
  order                 Int      @default(0) @map("order")
  createdAt             DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt             DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@index([formId], map: "idx_questions_form_id")
  @@map("questions")
}

model Route {
  id        String   @id @default(uuid()) @db.VarChar(36)
  name      String   @db.VarChar(255)
  color     String?  @db.VarChar(7)
  stopIds   Json?    @map("stop_ids")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@index([name], map: "idx_routes_name")
  @@map("routes")
}

model RouteRun {
  id        String   @id @default(uuid()) @db.VarChar(36)
  day       String   @db.VarChar(20)
  snapshot  Json
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([day], map: "idx_route_runs_day")
  @@index([createdAt], map: "idx_route_runs_created_at")
  @@map("route_runs")
}

model Schedule {
  id        String   @id @default(uuid()) @db.VarChar(36)
  clientId  String   @unique @map("client_id") @db.VarChar(36)
  monday    Boolean? @default(true)
  tuesday   Boolean? @default(true)
  wednesday Boolean? @default(true)
  thursday  Boolean? @default(true)
  friday    Boolean? @default(true)
  saturday  Boolean? @default(true)
  sunday    Boolean? @default(true)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  @@index([clientId], map: "idx_schedules_client_id")
  @@map("schedules")
}

model Setting {
  id        String   @id @default(uuid()) @db.VarChar(36)
  key       String   @unique @db.VarChar(255)
  value     String
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([key], map: "idx_settings_key")
  @@map("settings")
}

model Signature {
  id        String   @id @default(uuid()) @db.VarChar(36)
  clientId  String   @map("client_id") @db.VarChar(36)
  orderId   String?  @map("order_id") @db.VarChar(36)
  slot      Int
  strokes   Json
  signedAt  DateTime @default(now()) @map("signed_at") @db.Timestamp(6)
  ip        String?  @db.VarChar(90)
  userAgent String?  @map("user_agent") @db.VarChar(1000)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@unique([clientId, slot])
  @@index([clientId], map: "idx_signatures_client_id")
  @@index([signedAt], map: "idx_signatures_signed_at")
  @@index([orderId], map: "idx_signatures_order_id")
  @@map("signatures")
}

model Stop {
  id               String    @id @default(uuid()) @db.VarChar(36)
  day              String    @db.VarChar(40)
  clientId         String?   @map("client_id") @db.VarChar(36)
  order            Int?      @map("order")
  name             String    @db.VarChar(510)
  address          String    @db.VarChar(1000)
  apt              String?   @db.VarChar(100)
  city             String    @db.VarChar(200)
  state            String    @db.VarChar(4)
  zip              String    @db.VarChar(20)
  phone            String?   @db.VarChar(40)
  dislikes         String?
  lat              Float?
  lng              Float?
  completed        Boolean?  @default(false)
  proofUrl         String?   @map("proof_url") @db.VarChar(1000)
  assignedDriverId String?   @map("assigned_driver_id") @db.VarChar(36)
  createdAt        DateTime  @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt        DateTime  @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  orderId          String?   @map("order_id") @db.VarChar(36)
  deliveryDate     DateTime? @map("delivery_date") @db.Date
  // Note: orderId can reference either orders.id or upcoming_orders.id
  // Foreign key constraint removed to allow both table references

  @@index([day], map: "idx_stops_day")
  @@index([deliveryDate], map: "idx_stops_delivery_date")
  @@index([clientId], map: "idx_stops_client_id")
  @@index([orderId], map: "idx_stops_order_id")
  @@index([completed], map: "idx_stops_completed")
  @@map("stops")
}

model UpcomingOrder {
  id                    String    @id @default(uuid()) @db.VarChar(36)
  clientId              String    @map("client_id") @db.VarChar(36)
  serviceType           String    @map("service_type") @db.VarChar(50)
  caseId                String?   @map("case_id") @db.VarChar(255)
  status                String    @default("scheduled") @db.VarChar(50)
  scheduledDeliveryDate DateTime? @map("scheduled_delivery_date") @db.Date
  takeEffectDate        DateTime? @map("take_effect_date") @db.Date
  deliveryDay           String?   @map("delivery_day") @db.VarChar(50)
  deliveryDistribution  Json?     @map("delivery_distribution")
  totalValue            Decimal?  @map("total_value") @db.Decimal(10, 2)
  totalItems            Int?      @map("total_items")
  billAmount            Decimal?  @map("bill_amount") @db.Decimal(10, 2)
  notes                 String?
  orderNumber           Int?      @map("order_number")
  processedOrderId      String?   @map("processed_order_id") @db.VarChar(36)
  processedAt           DateTime? @map("processed_at") @db.Timestamp(6)
  lastUpdated           DateTime  @default(now()) @updatedAt @map("last_updated") @db.Timestamp(6)
  updatedBy             String?   @map("updated_by") @db.VarChar(255)
  createdAt             DateTime  @default(now()) @map("created_at") @db.Timestamp(6)
  meal_type             String?   @default("Lunch")
  vendorId              String?   @map("vendor_id") @db.VarChar(36)

  @@index([orderNumber], map: "idx_upcoming_orders_order_number")
  @@index([processedOrderId], map: "idx_upcoming_orders_processed_order_id")
  @@index([clientId], map: "idx_upcoming_orders_client_id")
  @@index([status], map: "idx_upcoming_orders_status")
  @@index([vendorId], map: "idx_upcoming_orders_vendor_id")
  @@map("upcoming_orders")
}

model UpcomingOrderBoxSelection {
  id              String   @id @default(uuid()) @db.VarChar(36)
  upcomingOrderId String   @map("upcoming_order_id") @db.VarChar(36)
  vendorId        String   @map("vendor_id") @db.VarChar(36)
  boxTypeId       String?  @map("box_type_id") @db.VarChar(36)
  quantity        Int      @default(1)
  items           Json?
  createdAt       DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([upcomingOrderId], map: "idx_upcoming_order_box_selections_upcoming_order_id")
  @@index([vendorId], map: "idx_upcoming_order_box_selections_vendor_id")
  @@index([boxTypeId], map: "idx_upcoming_order_box_selections_box_type_id")
  @@map("upcoming_order_box_selections")
}

model UpcomingOrderItem {
  id                        String           @id @default(uuid()) @db.VarChar(36)
  upcomingOrderId           String           @map("upcoming_order_id") @db.VarChar(36)
  vendorSelectionId         String?          @map("vendor_selection_id") @db.VarChar(36)
  upcomingVendorSelectionId String?          @map("upcoming_vendor_selection_id") @db.VarChar(36)
  menuItemId                String?          @map("menu_item_id") @db.VarChar(36)
  quantity                  Int              @default(1)
  createdAt                 DateTime         @default(now()) @map("created_at") @db.Timestamp(6)
  notes                     String?
  custom_name               String?
  custom_price              Decimal?         @db.Decimal(10, 2)
  meal_item_id              String?          @db.VarChar(36)
  breakfast_items           breakfast_items? @relation(fields: [meal_item_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([upcomingOrderId], map: "idx_upcoming_order_items_upcoming_order_id")
  @@index([vendorSelectionId], map: "idx_upcoming_order_items_vendor_selection_id")
  @@index([upcomingVendorSelectionId], map: "idx_upcoming_order_items_upcoming_vendor_selection_id")
  @@index([menuItemId], map: "idx_upcoming_order_items_menu_item_id")
  @@map("upcoming_order_items")
}

model UpcomingOrderVendorSelection {
  id              String   @id @default(uuid()) @db.VarChar(36)
  upcomingOrderId String   @map("upcoming_order_id") @db.VarChar(36)
  vendorId        String?  @map("vendor_id") @db.VarChar(36)
  createdAt       DateTime @default(now()) @map("created_at") @db.Timestamp(6)

  @@index([upcomingOrderId], map: "idx_upcoming_order_vendor_selections_upcoming_order_id")
  @@index([vendorId], map: "idx_upcoming_order_vendor_selections_vendor_id")
  @@map("upcoming_order_vendor_selections")
}

model Vendor {
  id                String              @id @default(uuid()) @db.VarChar(36)
  name              String              @db.VarChar(255)
  email             String?             @db.VarChar(255)
  password          String?             @db.VarChar(255)
  serviceType       String?             @map("service_type") @db.VarChar(255)
  deliveryDays      Json?               @map("delivery_days")
  deliveryFrequency String?             @default("Once") @map("delivery_frequency") @db.VarChar(50)
  isActive          Boolean?            @default(true) @map("is_active")
  isDefault         Boolean?            @default(false) @map("is_default")
  minimumMeals      Int?                @default(0) @map("minimum_meals")
  cutoffHours       Int?                @default(0) @map("cutoff_hours")
  createdAt         DateTime            @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt         DateTime            @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  client_box_orders client_box_orders[]

  @@map("vendors")
}

model breakfast_categories {
  id              String            @id @default(dbgenerated("(uuid_generate_v4())::text")) @db.VarChar(36)
  name            String
  set_value       Decimal?          @db.Decimal(10, 2)
  created_at      DateTime          @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  meal_type       String            @default("Breakfast")
  sort_order      Int?              @default(0)
  breakfast_items breakfast_items[]

  @@index([meal_type], map: "idx_breakfast_categories_meal_type")
}

model breakfast_items {
  id                    String                 @id @default(dbgenerated("(uuid_generate_v4())::text")) @db.VarChar(36)
  category_id           String?                @db.VarChar(36)
  name                  String
  quota_value           Decimal?               @default(1) @db.Decimal(10, 2)
  price_each            Decimal?               @db.Decimal(10, 2)
  is_active             Boolean?               @default(true)
  created_at            DateTime               @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  sort_order            Int?                   @default(0)
  image_url             String?
  breakfast_categories  breakfast_categories?  @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  order_items           OrderItem[]
  upcoming_order_items  UpcomingOrderItem[]
  mealPlannerOrderItems MealPlannerOrderItem[]

  @@index([category_id])
}

model client_box_orders {
  id          String    @id @default(dbgenerated("(uuid_generate_v4())::text")) @db.VarChar(36)
  client_id   String    @db.VarChar(36)
  case_id     String?
  box_type_id String?   @db.VarChar(36)
  vendor_id   String?   @db.VarChar(36)
  quantity    Int?      @default(1)
  items       Json?     @default("{}")
  item_notes  Json?     @default("{}")
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  box_types   BoxType?  @relation(fields: [box_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  clients     Client    @relation(fields: [client_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  vendors     Vendor?   @relation(fields: [vendor_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model MealPlannerCustomItem {
  id            String    @id @default(uuid()) @db.VarChar(36)
  clientId      String?   @map("client_id") @db.VarChar(36)
  calendarDate  DateTime  @map("calendar_date") @db.Date
  name          String    @db.VarChar(255)
  quantity      Int       @default(1)
  price         Decimal?  @db.Decimal(10, 2)
  value         Decimal?  @db.Decimal(10, 2)
  sortOrder     Int?      @default(0) @map("sort_order")
  expirationDate DateTime? @map("expiration_date") @db.Date
  createdAt     DateTime  @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime  @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  client Client? @relation(fields: [clientId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([clientId], map: "idx_meal_planner_custom_items_client_id")
  @@index([calendarDate], map: "idx_meal_planner_custom_items_calendar_date")
  @@index([clientId, calendarDate], map: "idx_meal_planner_custom_items_client_date")
  @@map("meal_planner_custom_items")
}

model MealPlannerOrder {
  id                    String                 @id @default(uuid()) @db.VarChar(36)
  clientId              String                 @map("client_id") @db.VarChar(36)
  caseId                String?                @map("case_id") @db.VarChar(255)
  status                String                 @default("draft") @db.VarChar(50)
  scheduledDeliveryDate DateTime?              @map("scheduled_delivery_date") @db.Date
  deliveryDay           String?                @map("delivery_day") @db.VarChar(50)
  totalValue            Decimal?               @map("total_value") @db.Decimal(10, 2)
  totalItems            Int?                   @map("total_items")
  items                 Json?
  notes                 String?
  processedOrderId      String?                @map("processed_order_id") @db.VarChar(36)
  processedAt           DateTime?              @map("processed_at") @db.Timestamp(6)
  userModified          Boolean                @default(false) @map("user_modified")
  createdAt             DateTime               @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt             DateTime               @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  client  Client                 @relation(fields: [clientId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  orderItems MealPlannerOrderItem[]

  @@index([clientId], map: "idx_meal_planner_orders_client_id")
  @@index([caseId], map: "idx_meal_planner_orders_case_id")
  @@index([status], map: "idx_meal_planner_orders_status")
  @@index([scheduledDeliveryDate], map: "idx_meal_planner_orders_scheduled_delivery_date")
  @@index([processedOrderId], map: "idx_meal_planner_orders_processed_order_id")
  @@map("meal_planner_orders")
}

model MealPlannerOrderItem {
  id                 String   @id @default(uuid()) @db.VarChar(36)
  mealPlannerOrderId String   @map("meal_planner_order_id") @db.VarChar(36)
  mealType           String   @map("meal_type") @db.VarChar(50)
  menuItemId         String?  @map("menu_item_id") @db.VarChar(36)
  mealItemId         String?  @map("meal_item_id") @db.VarChar(36)
  quantity           Int      @default(1)
  notes              String?
  customName         String?  @map("custom_name") @db.VarChar(255)
  customPrice        Decimal? @map("custom_price") @db.Decimal(10, 2)
  sortOrder          Int?     @default(0) @map("sort_order")
  createdAt          DateTime @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt          DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)

  mealPlannerOrder MealPlannerOrder @relation(fields: [mealPlannerOrderId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  menuItem         MenuItem?        @relation(fields: [menuItemId], references: [id], onDelete: SetNull, onUpdate: NoAction)
  mealItem         breakfast_items? @relation(fields: [mealItemId], references: [id], onDelete: SetNull, onUpdate: NoAction)

  @@index([mealPlannerOrderId], map: "idx_meal_planner_order_items_order_id")
  @@index([menuItemId], map: "idx_meal_planner_order_items_menu_item_id")
  @@index([mealItemId], map: "idx_meal_planner_order_items_meal_item_id")
  @@index([mealType], map: "idx_meal_planner_order_items_meal_type")
  @@map("meal_planner_order_items")
}
